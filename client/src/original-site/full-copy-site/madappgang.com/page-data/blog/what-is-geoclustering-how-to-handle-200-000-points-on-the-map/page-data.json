{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/what-is-geoclustering-how-to-handle-200-000-points-on-the-map","webpackCompilationHash":"1b1fc49861966475dd9a","result":{"data":{"markdownRemark":{"id":"82eda22a-b0d8-57db-9daa-27fd1d845909","html":"<p>While making an application for truck drivers, we faced an engineering challenge plotting location data on a map in a way that overwhelming volumes wouldn’t crash users’ phones. We had more than 200,000 geopoints and needed them to be grouped into certain categories so that a driver would operate within these categories instead of seeing all the points at once.</p>\n<p>We solved this issue by applying a particular clustering technique. Let’s now get a grasp on what geoclustering is and which methods of grouping location data are out there.</p>\n<h2>Crafting a Cluster Management Tool for an App</h2>\n<p>A geoclustering tool, along with a powerful map are the fundamentals of any location-based or navigation application. When you use an application which deals with lots of data on a daily basis, you need this data to be loud and simple, divided into visually acceptable parts. And this is what clustering serves to do; structuring data and making it understandable.</p>\n<p>If you want to develop an app with some mapping functions, you should know how many geopoints will be included. Our guess is that there will be a lot. Now, with each geopoint being shown as a separate marker, imagine a map filled with markers overlapping each other. Messy, right? To handle thousands of points and make your service effective but not disturbing is quite a piece of work. </p>\n<p>As we’ve mentioned, we needed to handle 200,000 points in the <a href=\"https://madappgang.com/projects/atlas\">Atlas</a> project. The app’s end users were truck drivers who needed an easy-to-use tool for building the delivery route. So, the way geopoints were displayed and managed on the map was essential.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAADKElEQVQ4y12S229UVRSHDyjYTtvpZaadoTOz9+k5zK3TmZHaK9Vi2wGkQEnaqW0pLfQiFx80UDFS0/iA1iYTCzEp4VJQaUuiGBNLeNAYo3+AxndfCA/EEIUWaYNK8rnnzKjUhy8rZ+ec7/zWXkurEleJiCtZLmfJPsuPVJ1dc1YlPyEmrhGVC1aNybVopcYhnP4BSv3DlAVGrOo0D+DcPECxsR9X8LBiVJ0PWWcOo4+QnCEuPs1I/y90+PspC4/iCB7AvrkDu7mHArOdAmM37lASs/E8rqoTOPw9lEeP44ocwRRTxOV1JZy3pE+ilQaGKA0NU6DvZIN3i+I5ckSN+lOUpubdfDk1jTs8QKG+B1n9Dt5nT2H6Ji1hTAni6WTiPzRX6CjOwAB67RR5xnaeEfXY9OfJr9jK4d5D8M0s3ckPsRknKDH2Umx24pcfKNFnRHxzhL3plHNZ5jMJHf4+NsWOqzZ3YZPNStrK9kQXYwdH6G1rYXhXD4l9E+TrXUqYJKifUbJ5RHA//lgnJaIXh+ijSHShuUOvqPvr52lPnI2+GkWdopZ15artsmo0Z4zz5y6wtPyA9858Qa63k4CcJqwmHqocon3ru7j0fuy+doLGOFqup4NCsw9bRbMlS7ecJkfWk6c38JQSf3z9K+4trXD31yVOTy8gylIq4RUKjUGK3K9jL++mSO5Dmm+gvbBjgotXF3GEW6yP07KNvow0V29EK6kiNTPH/eVVbt/5hd+W7jGd+gFj00UCkREO7n2LlppTuMUgrYmdaN9/d5fVx39RUdvBOne1Stbwb0qbGoxmDzH+/jke/P6IG4s/c+vOCvdv3+KnC9dYXVyAH28yM55ivejBHe1Fe/u1CeZmL+GNvMh6T61amfpsyjolVAkLKzlycpLVPx7z6uBpxo+d5NHX8zz8/CzfTo6RGnqZRKKdyoYdRBtfQqsWHrb4vJT44mwQKt0T9/hPy8nRN1le+ZOxY6MEiwvoqKthWySi9k5S6fFSpwuaTGmh5cs2tdRt5IqmNUPJCBusKbcmj6qhPKR7eEItfKN6t4Uc7zbyZSt29W2eqjaR4W+egOIa+1MqdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/fc37f40cf29010cbea9858f66b5ade6b/8d857/what-is-geoclustering-1.webp 185w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/844ee/what-is-geoclustering-1.webp 370w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/97fdf/what-is-geoclustering-1.webp 740w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/b7d96/what-is-geoclustering-1.webp 1110w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/97218/what-is-geoclustering-1.webp 1480w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/f07e4/what-is-geoclustering-1.webp 1920w\"\n          sizes=\"(max-width: 740px) 100vw, 740px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/fc37f40cf29010cbea9858f66b5ade6b/3f118/what-is-geoclustering-1.png 185w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/a54ee/what-is-geoclustering-1.png 370w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/4dacc/what-is-geoclustering-1.png 740w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/cba50/what-is-geoclustering-1.png 1110w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/171ed/what-is-geoclustering-1.png 1480w,\n/static/fc37f40cf29010cbea9858f66b5ade6b/9b4a8/what-is-geoclustering-1.png 1920w\"\n          sizes=\"(max-width: 740px) 100vw, 740px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/fc37f40cf29010cbea9858f66b5ade6b/4dacc/what-is-geoclustering-1.png\"\n          alt=\"geoclustering approaches\"\n          title=\"geoclustering approaches\"\n        />\n      </picture>\n    </span></p>\n<h2>Clustering Approaches</h2>\n<p>Clustering tools have been out there for years. The complication is which one to choose. Apart from different algorithms, there are different programming languages such a tool can be developed with, and two different approaches: server-side and client-side clustering.</p>\n<p>There are several techniques of data clustering which can be easily applied to geopoints:</p>\n<ul>\n<li>K-means: every geopoint is attached to a group with the closest centre, and centres are defined as the means of all vectors in the group</li>\n<li>Mean-shift clustering: centres are the means of points situated within a certain dense area</li>\n<li>DBSCAN: outliers aren’t classified into clusters but identified as noises</li>\n<li>Gaussian Mixture Models: geopoints are attributed to a cluster if they are close to the Gaussian centre</li>\n<li>Hierarchical clustering: while each geopoint is taken as a cluster, the average distance between them is calculated, then points with the smallest average linkage are combined</li>\n</ul>\n<p>At MadAppGang we utilised hierarchical greedy clustering based on KD-tree geospatial indexes.</p>\n<h2>Why We Needed a New Geoclustering Solution</h2>\n<p>There are lots of clustering tools like <a href=\"https://github.com/googlemaps/v3-utility-library/tree/master/markerclusterer\">MarkerClusterer</a> for Google Maps API, a Leaflet’s plugin <a href=\"https://github.com/Leaflet/Leaflet.markercluster\">Marker Cluster</a>, Mapbox’s Supercluster, or <a href=\"https://github.com/biodiv/anycluster\">Anycluster</a>. But we needed another, much more optimizable solution. Instead of searching for the best cluster management software, you can always write your own code for clustering according to your project’s goals, and this is exactly what we did.</p>\n<img class=\"full-width\" src=\"/uploads/what-is-geoclustering-title.png\" alt=\"What is geoclustering\" />\n<h2>Why We Chose Server-Side Clustering</h2>\n<p>First of all, it’s best doing clustering at the server’s side. There are several easy to implement cluster management software solutions but they are managed on the client’s side. It increases response payload significantly and wastes time and memory on the client’s side. </p>\n<p>While grouping points on the server’s side, there’s no need to build clusters each time on a client’s screen. Let’s say you have 100,000 points categorised in 100 clusters; with a server-side approach, clusters will be calculated one time on the server, while client-side clustering will require performing the same process by each client. </p>\n<p>Server-side clustering will create a cache which will be transformed each time points are added or deleted. You can even pre-cache what’s kept on the server on a content delivery network to decrease the server’s load and reduce latency. Loading large volumes of data without managing clusters on the server slows down the app’s performance.</p>\n<h2>Why We Used Golang</h2>\n<p>Aiming for the fastest solution possible, we developed a clustering library using Golang. In most cases, <a href=\"https://hackernoon.com/5-reasons-why-we-switched-from-python-to-go-4414d5f42690\">Go is the fastest</a> programming language which is helpful for processing many geopoints and combining them by certain criteria.</p>\n<p>Clusters developed with other languages − be it Node, PHP, Python, or Ruby − are slow compared to Golang-based solutions. And some of those open source solutions for spatial data that are written in Golang (geo.go, tile38, rtreego) were not suitable for our project as they were too complicated, slowed down performance, or consumed too much memory.</p>\n<p>Finally, we optimised the kdbush library, building our own library for clustering geopoints called <a href=\"https://github.com/MadAppGang/gocluster\">Gocluster</a>. Since kdbush was written in JavaScript, we wrote a <a href=\"https://github.com/MadAppGang/kdbush\">framework</a> for implementing the same algorithm in Golang.</p>\n<p>With that said, we developed a library for building KD trees that worked with only 2D points. A library that also works with polygons and processes any quantity of coordinates in many-dimensional spaces is much less efficient. </p>\n<p>Our Gocluster, based on KD-tree geospatial index, groups points using Mercator projection at different scales. Comparing our solution with Mapbox’s Supercluster written in JavaScript, we discovered that it worked 40 times faster and took 20 times less memory. It works this fast as you can’t change the index in the process but only rewrite it. It took Gocluster 0.5 sec and 10 MB of memory to process 21 map layers with 1,000,000 geopoints. Owing to such speed, we can update all indexes while adding or replacing points in real time.</p>\n<h2>Apps With Geodata</h2>\n<p>Travelling and delivery applications are flourishing, with more solutions being developed all the time and the most demanded ones getting millions of downloads worldwide. When it comes to making a popular application with navigational functions, a map with apprehensible data chunks is a pressing need. </p>\n<p>Making clusters is what helps projects deal with massive amounts of data. And making a proper cluster monitoring and management tool is a challenge you will face while working on a project with a geo-powered map. Feel free to contact us to discuss your ideas or if you’d like help with geoclustering.</p>","frontmatter":{"banner":"/uploads/what-is-geoclustering-title-dark.png","socialGraphImage":"/uploads/what-is-geoclustering-title-social.png","date":"10 July 2019","title":"What Is Geoclustering? How to Handle 200,000 Points on the Map","tags":["geoclustering","cluster management"],"seoTitle":"What Is Geoclustering? Different Approaches Used in App Development","seoDescription":"Many mobile applications require clustering tools to group geopoints and make tons of data usable. To choose the method that best suits your project, you need to understand what geoclustering is and the ways it can be applied.","authors":[{"name":"Anastasia Osypenko","position":"Market Researcher","photo":"/uploads/33528361_2057379984303360_5847473041495293952_o.jpg"}]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"82eda22a-b0d8-57db-9daa-27fd1d845909","socialGraphImage":"/uploads/what-is-geoclustering-title-social.png","seoTitle":"What Is Geoclustering? Different Approaches Used in App Development","seoDescription":"Many mobile applications require clustering tools to group geopoints and make tons of data usable. To choose the method that best suits your project, you need to understand what geoclustering is and the ways it can be applied."}}}